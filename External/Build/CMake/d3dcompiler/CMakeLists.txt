set(D3DCOMPILER_DIR "${EXTERNAL_PROJECT_DIR}/d3dcompiler")

set(D3DCOMPILER_NAME "d3dcompiler_47.dll")
set(REL_PATH "External/Downloads/d3dcompiler.7z")
set(PACKAGE_FILE_ID "ADBE87907BA0119B99A34C83BB4F36ABB858F328")

DOWNLOAD_PACKAGE("d3dcompiler" ${REL_PATH} ${PACKAGE_FILE_ID} "${D3DCOMPILER_DIR}/DirectX SDK EULA.txt")

if(KLAYGE_PLATFORM_WINDOWS)
	set(D3DCOMPILER_ARCH_NAME ${KLAYGE_ARCH_NAME})
else()
	set(D3DCOMPILER_ARCH_NAME "x86")
endif()
set(SRC_PATH "${D3DCOMPILER_DIR}/Redist/${D3DCOMPILER_ARCH_NAME}/${D3DCOMPILER_NAME}")
set(REDIST_PATH "${KLAYGE_BIN_DIR}/${D3DCOMPILER_NAME}")
add_custom_command(OUTPUT ${REDIST_PATH}
	COMMAND ${CMAKE_COMMAND} -E copy_if_different ${SRC_PATH} ${REDIST_PATH})
add_custom_target(D3DCompilerRedist ALL DEPENDS ${REDIST_PATH})

set_target_properties(D3DCompilerRedist PROPERTIES FOLDER "${EXTERNAL_VS_FOLDER_PREFIX}/D3DCompiler")
